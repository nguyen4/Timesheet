<!DOCTYPE html>
<html>

    <head>
        <meta charset="utf-8">
        <title>TimeSheet Maker</title>
        <link rel="stylesheet" href="input.css">
        <link rel="stylesheet" href="vendor/css/grid.css">
        <link rel="stylesheet" href="vendor/css/toggle-switch.css">
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <link href="https://gitcdn.github.io/bootstrap-toggle/2.3.2/css/bootstrap-toggle.min.css" rel="stylesheet">
        <script src="https://gitcdn.github.io/bootstrap-toggle/2.3.2/js/bootstrap-toggle.min.js"></script>
        <script>
  
            var ids = [ 'mon-date-1', 'mon-start-1', 'mon-end-1',
                        'tue-date-1', 'tue-start-1', 'tue-end-1',
                        'wed-date-1', 'wed-start-1', 'wed-end-1',
                        'thu-date-1', 'thu-start-1', 'thu-end-1',
                        'fri-date-1', 'fri-start-1', 'fri-end-1',
                        'sat-date-1', 'sat-start-1', 'sat-end-1',
                        'sun-date-1', 'sun-start-1', 'sun-end-1',
                        'mon-date-2', 'mon-start-2', 'mon-end-2',
                        'tue-date-2', 'tue-start-2', 'tue-end-2',
                        'wed-date-2', 'wed-start-2', 'wed-end-2',
                        'thu-date-2', 'thu-start-2', 'thu-end-2',
                        'fri-date-2', 'fri-start-2', 'fri-end-2',
                        'sat-date-2', 'sat-start-2', 'sat-end-2',
                        'sun-date-2', 'sun-start-2', 'sun-end-2'
                      ];
            
            var date_ids = [ '#mon-date-1',
                             '#tue-date-1',
                             '#wed-date-1',
                             '#thu-date-1',
                             '#fri-date-1',
                             '#sat-date-1',
                             '#sun-date-1',
                             '#mon-date-2',
                             '#tue-date-2',
                             '#wed-date-2',
                             '#thu-date-2',
                             '#fri-date-2',
                             '#sat-date-2',
                             '#sun-date-2'
                           ]
            
            function packageData() {
                
                localStorage.clear();
                //saveName();
                saveElements();
                saveCanvas();
                
            }
            
            function serialize(canvas) {
                return canvas.toDataURL();
            }
            
            function saveCanvas() {
                //localStorage["canvas"] = serialize(document.getElementById('canvas'));
                var signature = serialize(document.getElementById('canvas'));
                localStorage['canvas'] = signature;
            }
            
            function saveElements() {
                
                for (var i = 0; i < ids.length; i++){
                
                    localStorage.setItem(ids[i], document.getElementById(ids[i]).value);
            
                } 
            }
            
            function saveName() {
                
                localStorage['name'] = $('#name').val();
                console.log(localStorage['name']);
            }
   
    </script>
    
    <script>

        var startMon, endSun, currentMon, currentSun;
        
        $(document).ready(function() {
            initWeekRange();
            fillWeekHeader( startMon, endSun );
            currentMon = new Date( startMon.getTime() );
            currentSun = new Date( endSun.getTime() );
            autofillDate( currentMon, currentSun );
        });
         
        function refreshCard(left){
            switchWeeks( left, currentMon, currentSun );
            autofillDate( currentMon, currentSun );
        }
        
        function initWeekRange(){
            endSun = getSunday();
            startMon = getSunday();
            startMon.setHours(-24 * 13);
        }
        
        function fillWeekHeader(Mon, Sun) {
            
            var mondayDate = stringifyDate(Mon),
                sundayDate = stringifyDate(Sun);
            
             $('#week').text(mondayDate + ' - ' + sundayDate);
        }
        
        function stringifyDate(date){
            
            var month    = date.getMonth() + 1,
                day      = date.getDate(),
                year     = date.getFullYear();
            
            return month + '/' + day + '/' + year;
        }
        
        function getSunday(){
            
            var date = new Date();
            var day = date.getDay();
            if ( day != 0 ){
                date.setHours(24 * (7 - day));
            }
            return date;
        }
            
        /*Button scripts*/
        
        function switchWeeks(left, monday, sunday){
            
            var newMonday, newSunday;
            
            if (left) {
                newMonday = goBackTwoWeeks(monday);
                newSunday = goBackTwoWeeks(sunday);  
            }
            else {
                newMonday = goForwardTwoWeeks(monday);
                newSunday = goForwardTwoWeeks(sunday);
            }
            
            $('#week').text(stringifyDate(newMonday) + ' - ' + stringifyDate(newSunday));
            currentMon = newMonday;
            currentSun = newSunday;
        }
        
        function goBackTwoWeeks(date){
            
            var newDate = new Date(date.getTime());
            newDate.setHours(-24 * 14);
            return newDate;
            
        }
        
        function goForwardTwoWeeks(date){
            
            var newDate = new Date(date.getTime());
            newDate.setHours(+24 * 14);
            return newDate;
            
        }
        
        function autofillDate(startDate, endDate){
                
            var dates = getListOfDates(startDate, endDate);
                
            try {
                
                if (dates.length != date_ids.length) { throw dates.length; }

                for (var i = 0; i < date_ids.length; i++) {
                    
                    var dd = dates[i].getDate(),
                        mm = dates[i].getMonth() + 1,
                        yyyy = dates[i].getFullYear();
                    
                    var stringDate = (mm + '/' + dd + '/' + yyyy);
                    $(date_ids[i]).text(stringDate);
                }
                
            } catch (e) {
                console.log('Incorrect number of dates. There are ' + e + ' dates');
            }
        }
        
        function getListOfDates(startDate, endDate) {
            
            var list = [startDate];
            var endDay = endDate.getDate();
            var endMonth = endDate.getMonth();
            var endYear = endDate.getFullYear();
            var current = list[0];
            var nextDate;
            
            while ( current.getDate()       != endDay    ||
                    current.getMonth()      != endMonth  ||
                    current.getFullYear()   != endYear    
                  ) 
            {
                nextDate = new Date(current.getTime());
                nextDate.setDate(nextDate.getDate() + 1);
                list.push(nextDate);
                current = list[list.length - 1];
            }
                     
            return list;
        }
        
        
    </script>    
    </head>
    
    <body>
        
        <nav>
            <img src='resources/images/Logo.jpeg' alt="logo">
        </nav>
        <!--<section>
            <div class="row section-step-1">
                
                <h1>Step 1</h1>
                <h2>Tell us your name</h2>
                
                <div>
                    <input id="name" type="text" class="name" placeholder="Your name">   
                </div>
                
            </div>
            
        </section>
        <section>-->
        
        <div class="card dim">
        
            <div class="row section-step-1">
                
                <!--<h1>Step 2</h1>
                <h2>Log your hours</h2>-->
                
                <div class="date-container">
                    <div class="row">
                        <div class="col span-1-of-5 switch-item" id="left-button">
                            <button class="switch-icon switch-button left" type="button" id="go-back">&lt</button>
                            <script>
                            $('#go-back').click(function(){
                               refreshCard(true);
                            });
                            </script>
                        </div>
                        <div class="col span-3-of-5 switch-item">
                            
                            <span id="week"></span>
                            
                        </div>
                        <div class="col span-1-of-5 switch-item" id="left-button">
                            <button class="switch-icon switch-button right" type="button" id="go-forward">&gt</button>
                            <script>
                            $('#go-forward').click(function(){
                               refreshCard(false);
                            });
                            </script>
                        </div>
                    </div>
                </div>
                
                <div class="hour-log">
                    
<!--                <form id="week-1" method="post" class="log-form" style="text-align: center;">-->
                    
                    <!--<div class="week-num">
                        <h3>Week 1</h3>
                    </div>-->
                    
                    <!--<div id="titles" class="day-row">
                        
                        <div>
                            <div class="col span-1-of-4">
                             <label>Day</label>
                        </div>
                        <div class="col span-1-of-4">
                             <label>Date</label>
                        </div> 
                        </div>
                        
                        <div class="col span-1-of-4">
                             <label>Start Time</label> 
                        </div>
                        <div class="col span-1-of-4">
                             <label>End Time</label>
                        </div>

                    </div>-->
                    <div id="week-1" class="log-form">
                    
                    
                    <div id="mon-1" class="row"  style="border-bottom: 1px solid #e2e2e2;">
                        
                        <div class="clear-margins col span-1-of-5">
                            
                                <div class="col span-1-of-2">
                                     <span>MON</span>
                                </div>
                                <div class="col span-1-of-2">
                                    <span id="mon-date-1" class="input"></span> 
                                </div>
                            
                        </div>
                        
                        <div class="col span-2-of-5">
                            <div class="col span-1-of-2">
                                <input type="text" id="mon-start-1" class="input">
                            </div>
                            
                            <div class="col span-1-of-2">
                                <input type="checkbox" checked data-toggle="toggle">   
                            </div>
                            
                        </div>
                        <div class="col span-2-of-5">
                            <div class="col span-1-of-2">
                                <input type="text" id="mon-end-1" class="input">
                            </div>
                            
                            <div class="col span-1-of-2">
                                <input type="checkbox" checked data-toggle="toggle">
                            </div>
                            
                        </div>

                    </div>

</div>
                    <!--<div id="tue-1" class="row">
                        
                        <div class="col span-1-of-5">
                            <div class="col span-1-of-2">
                             <span>TUE</span>
                            </div>
                            <div class="col span-1-of-2">
                                <span id="tue-date-1" class="input"></span>
                            </div>
                        </div>
                         
                        <div class="col span-2-of-5">
                            <input type="text" id="tue-start-1" class="input time-input">
                        </div>
                        <div class="col span-2-of-5">
                            <input type="text" id="tue-end-1" class="input time-input">
                        </div>

                    </div>

                    <div id="wed-1" class="row">

                        <div class="col span-1-of-4 day">
                             <label>WED</label>
                        </div>
                        <div class="col span-1-of-4">
                            <span id="wed-date-1" class="input"></span>
                        </div> 
                        <div class="col span-1-of-4">
                            <input type="time" id="wed-start-1" class="input time-input">
                        </div>
                        <div class="col span-1-of-4">
                            <input type="time" id="wed-end-1" class="input time-input">
                        </div>

                    </div>

                    <div id="thur-1" class="row">

                        <div class="col span-1-of-4 day">
                             <label>THU</label>
                        </div>
                        <div class="col span-1-of-4">
                            <span id="thu-date-1" class="input"></span>
                        </div> 
                        <div class="col span-1-of-4">
                            <input type="time" id="thu-start-1" class="input time-input">
                        </div>
                        <div class="col span-1-of-4">
                            <input type="time" id="thu-end-1" class="input time-input">
                        </div>

                    </div>

                    <div id="fri-1" class="row">

                        <div class="col span-1-of-4 day">
                             <label>FRI</label>
                        </div>
                        <div class="col span-1-of-4">
                            <span id="fri-date-1" class="input"></span> 
                        </div> 
                        <div class="col span-1-of-4">
                            <input type="time" id="fri-start-1" class="input time-input">
                        </div>
                        <div class="col span-1-of-4">
                            <input type="time" id="fri-end-1" class="input time-input">
                        </div>

                    </div>

                    <div id="sat-1" class="row">

                        <div class="col span-1-of-4 day">
                             <label>SAT</label>
                        </div>
                        <div class="col span-1-of-4">
                            <span id="sat-date-1" class="input"></span>
                        </div> 
                        <div class="col span-1-of-4">
                            <input type="time" id="sat-start-1" class="input time-input">
                        </div>
                        <div class="col span-1-of-4">
                            <input type="time" id="sat-end-1" class="input time-input">
                        </div>

                    </div>

                    <div id="sun-1" class="row">

                        <div class="col span-1-of-4 day">
                             <label>SUN</label>
                        </div>
                        <div class="col span-1-of-4">
                            <span id="sun-date-1" class="input"></span>
                        </div> 
                        <div class="col span-1-of-4">
                            <input type="time" id="sun-start-1" class="input time-input">
                        </div>
                        <div class="col span-1-of-4">
                            <input type="time" id="sun-end-1" class="input time-input">
                        </div>

                    </div>

                </form>
                
                <form id="week-2" method="post" class="log-form">
                        
                    <div class="week-num">
                        <h3>Week 2</h3>
                    </div>

                    <div id="titles" class="row">

                        <div class="col span-1-of-4">
                             <label>Day</label>
                        </div>
                        <div class="col span-1-of-4">
                             <label>Date</label>
                        </div> 
                        <div class="col span-1-of-4">
                             <label>Start Time</label> 
                        </div>
                        <div class="col span-1-of-4">
                             <label>End Time</label>
                        </div>

                    </div>

                    <div id="mon-2" class="row">

                        <div class="col span-1-of-4 day">
                             <label>MONDAY</label>
                        </div>
                        <div class="col span-1-of-4">
                            <span id="mon-date-2" class="input"></span>
                        </div> 
                        <div class="col span-1-of-4">
                            <input type="time" id="mon-start-2" class="input time-input">
                        </div>
                        <div class="col span-1-of-4">
                            <input type="time" id="mon-end-2" class="input time-input">
                        </div>

                    </div>

                    <div id="tue-2" class="row">

                        <div class="col span-1-of-4 day">
                             <label>TUESDAY</label>
                        </div>
                        <div class="col span-1-of-4">
                            <span id="tue-date-2" class="input"></span>
                        </div> 
                        <div class="col span-1-of-4">
                            <input type="time" id="tue-start-2" class="input time-input">
                        </div>
                        <div class="col span-1-of-4">
                            <input type="time" id="tue-end-2" class="input time-input">
                        </div>

                    </div>

                    <div id="wed-2" class="row">

                        <div class="col span-1-of-4 day">
                             <label>WEDNESDAY</label>
                        </div>
                        <div class="col span-1-of-4">
                            <span type="text" id="wed-date-2" class="input"></span> 
                        </div> 
                        <div class="col span-1-of-4">
                            <input type="time" id="wed-start-2" class="input time-input">
                        </div>
                        <div class="col span-1-of-4">
                            <input type="time" id="wed-end-2" class="input time-input">
                        </div>

                    </div>

                    <div id="thur-2" class="row">

                        <div class="col span-1-of-4 day">
                             <label>THURDAY</label>
                        </div>
                        <div class="col span-1-of-4">
                            <span id="thu-date-2" class="input"></span>
                        </div> 
                        <div class="col span-1-of-4">
                            <input type="time" id="thu-start-2" class="input time-input">
                        </div>
                        <div class="col span-1-of-4">
                            <input type="time" id="thu-end-2" class="input time-input">
                        </div>

                    </div>

                    <div id="fri-2" class="row">

                        <div class="col span-1-of-4 day">
                             <label>FRIDAY</label>
                        </div>
                        <div class="col span-1-of-4">
                            <span id="fri-date-2" class="input"></span>
                        </div> 
                        <div class="col span-1-of-4">
                            <input type="time" id="fri-start-2" class="input time-input">
                        </div>
                        <div class="col span-1-of-4">
                            <input type="time" id="fri-end-2" class="input time-input">
                        </div>

                    </div>

                    <div id="sat-2" class="row">

                        <div class="col span-1-of-4 day">
                             <label>SATURDAY</label>
                        </div>
                        <div class="col span-1-of-4">
                            <span type="text" id="sat-date-2" class="input"></span>
                        </div> 
                        <div class="col span-1-of-4">
                            <input type="time" id="sat-start-2" class="input time-input">
                        </div>
                        <div class="col span-1-of-4">
                            <input type="time" id="sat-end-2" class="input time-input">
                        </div>

                    </div>

                    <div id="sun-2" class="row">

                        <div class="col span-1-of-4 day">
                             <label>SUNDAY</label>
                        </div>
                        <div class="col span-1-of-4">
                            <span type="text" id="sun-date-2" class="input"></span>
                        </div> 
                        <div class="col span-1-of-4">
                            <input type="time" id="sun-start-2" class="input time-input">
                        </div>
                        <div class="col span-1-of-4">
                            <input type="time" id="sun-end-2" class="input time-input">
                        </div>

                    </div>

                </form>
-->
                
                </div>
            </div>
        </section>
        
        <section>
            
            <div class="row section-step-3">
                
                <h1>Step 3</h1>
                <h2>Sign Here</h2>
                
                <div class="container-sign">
                    <canvas id="canvas" style="width:600px; height:300px;" width="600" height="300" class="canvas-sign"></canvas>       
                    <script src="resources/js/signature-module.js"></script>
                </div>
                <div class="container-clear">
                    <input type="button" value="Clear" class="canvas-clear" />
                    <script>
                        $('.canvas-clear').on('click', function(e) {
                            var $canvas = $('#canvas');
                            var ctx = $canvas[0].getContext('2d');
                            c_width = $canvas.width();
                            c_height = $canvas.height();
                            ctx.clearRect(0, 0, c_width, c_height);
                            });
                    </script>
                </div>
            </div>
        
        </section>
        
        <section>
            
            <div class="row section-step-4">
                <h1>Step 4</h1>
                <h2>Click generate to make your timesheet</h2>
                <p>
                    <a class="btn btn-full generate" id="btn-generate" onClick="packageData()" href="generated.html">GENERATE</a>
                </p>
            </div>
            
        </section>
        </div>    
    </body>
</html>